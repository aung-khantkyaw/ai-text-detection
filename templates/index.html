<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Text Detective | Laziestant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            animation: {
              "fade-in": "fadeIn 0.6s ease-out",
              "slide-up": "slideUp 0.5s ease-out",
              "pulse-soft": "pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite",
            },
            keyframes: {
              fadeIn: {
                "0%": { opacity: "0", transform: "translateY(10px)" },
                "100%": { opacity: "1", transform: "translateY(0)" },
              },
              slideUp: {
                "0%": { opacity: "0", transform: "translateY(30px)" },
                "100%": { opacity: "1", transform: "translateY(0)" },
              },
            },
          },
        },
      };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <meta
      name="description"
      content="Advanced AI text detection powered by machine learning. Instantly identify AI-generated content vs human writing."
    />
  </head>
  <body
    class="min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-indigo-950 text-slate-100 overflow-x-hidden"
  >
    <!-- Floating Background Elements -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
      <div
        class="absolute top-1/4 left-1/4 w-96 h-96 bg-indigo-500/10 rounded-full blur-3xl animate-pulse-soft"
      ></div>
      <div
        class="absolute bottom-1/4 right-1/4 w-80 h-80 bg-purple-500/10 rounded-full blur-3xl animate-pulse-soft"
        style="animation-delay: 1s"
      ></div>
    </div>

    <!-- Header -->
    <header class="relative z-10 pt-8 pb-4">
      <div class="container mx-auto px-6">
        <nav class="flex items-center justify-between">
          <div class="flex items-center space-x-3">
            <div
              class="w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center"
            >
              <svg
                class="w-6 h-6 text-white"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"
                ></path>
              </svg>
            </div>
            <div>
              <h1
                class="text-xl font-bold bg-gradient-to-r from-indigo-400 to-purple-400 bg-clip-text text-transparent"
              >
                AI Text Detective
              </h1>
              <p class="text-xs text-slate-400">by Laziestant</p>
            </div>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a
              href="http://github.com/aung-khantkyaw"
              class="text-slate-400 text-sm"
              target="_blank"
              >GitHub</a
            >
          </div>
        </nav>
      </div>
    </header>

    <!-- Main Content -->
    <main class="relative z-10 container mx-auto px-6 py-8">
      <!-- Hero Section -->
      <div class="text-center mb-16 animate-fade-in">
        <h2
          class="text-5xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 bg-clip-text text-transparent leading-tight"
        >
          AI Text Detection API
        </h2>
        <p class="text-xl text-slate-300 max-w-2xl mx-auto leading-relaxed">
          Advanced machine learning algorithms analyze writing patterns to
          distinguish between
          <span class="text-indigo-400 font-semibold">AI-generated</span> and
          <span class="text-emerald-400 font-semibold">human-written</span>
          content.
        </p>
      </div>

      <!-- Detection Interface -->
      <div class="max-w-6xl mx-auto grid lg:grid-cols-5 gap-8">
        <!-- Main Prediction Card -->
        <div class="lg:col-span-3 animate-slide-up">
          <div
            class="bg-white/5 backdrop-blur-xl rounded-3xl p-8 border border-white/10 shadow-2xl"
          >
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-2xl font-semibold text-white flex items-center">
                <svg
                  class="w-6 h-6 mr-3 text-indigo-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M13 10V3L4 14h7v7l9-11h-7z"
                  ></path>
                </svg>
                Text Analyzer
              </h3>
              <span
                id="wordCount"
                class="px-3 py-1 bg-slate-800/60 rounded-full text-sm text-slate-300 border border-slate-700"
                >0 words</span
              >
            </div>

            <div class="space-y-4">
              <textarea
                id="inputText"
                rows="13"
                class="w-full px-6 py-4 bg-slate-900/60 border border-slate-700/50 rounded-2xl focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500/50 text-slate-100 placeholder-slate-400 resize-none transition-all duration-300"
                placeholder="Paste any text here to analyze whether it was written by AI or a human..."
              ></textarea>

              <div class="flex items-center justify-between">
                <button
                  id="predictBtn"
                  class="group px-8 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 hover:shadow-lg flex items-center"
                >
                  <svg
                    class="w-5 h-5 mr-2 group-hover:rotate-12 transition-transform"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                    ></path>
                  </svg>
                  Analyze Text
                </button>
                <span id="predictStatus" class="text-sm text-slate-400"></span>
              </div>
            </div>

            <!-- Results Card -->
            <div
              id="resultCard"
              class="hidden mt-8 p-6 bg-gradient-to-r from-slate-800/50 to-slate-700/50 rounded-2xl border border-slate-600/50 backdrop-blur-sm animate-fade-in"
            >
              <div class="flex items-center justify-between mb-4">
                <h4 class="text-lg font-semibold text-white flex items-center">
                  <svg
                    class="w-5 h-5 mr-2 text-emerald-400"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                    ></path>
                  </svg>
                  Analysis Result
                </h4>
                <span
                  id="confidenceBadge"
                  class="px-3 py-1 rounded-full text-xs font-medium bg-slate-700 text-slate-300"
                ></span>
              </div>

              <div id="predictionText" class="text-2xl font-bold mb-3"></div>
              <div id="probabilities" class="text-slate-300"></div>

              <!-- Confidence Meter -->
              <div class="mt-4">
                <div class="flex justify-between text-xs text-slate-400 mb-1">
                  <span>Human</span>
                  <span>AI</span>
                </div>
                <div class="w-full bg-slate-700 rounded-full h-2">
                  <div
                    id="confidenceMeter"
                    class="h-2 rounded-full transition-all duration-500"
                  ></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Sidebar -->
        <div
          class="space-y-6 animate-slide-up lg:col-span-2"
          style="animation-delay: 0.2s"
        >
          <!-- Model Status -->
          <div
            class="bg-white/5 backdrop-blur-xl rounded-2xl p-6 border border-white/10"
          >
            <h3 class="text-lg font-semibold mb-4 text-white flex items-center">
              <svg
                class="w-5 h-5 mr-2 text-emerald-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                ></path>
              </svg>
              Model Status
            </h3>
            <div id="modelStatus" class="space-y-3 text-sm">
              <div class="flex items-center">
                <div
                  class="w-2 h-2 bg-yellow-400 rounded-full mr-3 animate-pulse"
                ></div>
                <span class="text-slate-400">Loading status...</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <script>
      // Initialize app
      document.addEventListener("DOMContentLoaded", function () {
        initializeApp();
      });

      // App initialization
      function initializeApp() {
        loadModelStatus();
        setupEventListeners();
        setupWordCounter();
      }

      // Chart instances
      let accuracyChartInstance = null;
      let datasetChartInstance = null; // kept for backward compat, not used now
      let dataSplitChartInstance = null;

      // Utility: prettify names like 'LogisticRegression' -> 'Logistic Regression'
      function prettifyName(name) {
        if (typeof name !== "string") return "";
        return name
          .replace(/_/g, " ")
          .replace(/([a-z])([A-Z])/g, "$1 $2")
          .replace(/\s+/g, " ")
          .trim();
      }

      // Word counter functionality
      function setupWordCounter() {
        const inputText = document.getElementById("inputText");
        const wordCount = document.getElementById("wordCount");

        function updateWordCount() {
          const text = inputText.value.trim();
          const words = text ? text.split(/\s+/).length : 0;
          wordCount.textContent = `${words} word${words !== 1 ? "s" : ""}`;
        }

        inputText.addEventListener("input", updateWordCount);
        updateWordCount();
      }

      // Event listeners setup
      function setupEventListeners() {
        const predictBtn = document.getElementById("predictBtn");
        const inputText = document.getElementById("inputText");
        predictBtn.addEventListener("click", makePrediction);
        // Allow Enter key to submit (with Ctrl+Enter for new line)
        inputText.addEventListener("keydown", function (e) {
          if (e.key === "Enter" && e.ctrlKey) {
            e.preventDefault();
            makePrediction();
          }
        });
      }

      // Load model status and render UI
      async function loadModelStatus() {
        const statusContainer = document.getElementById("modelStatus");
        try {
          const response = await fetch("/api/info");
          const data = await response.json();

          const trained =
            data.model_status?.trained ?? data.model_meta?.trained ?? false;
          const algorithmRaw =
            data.model ||
            data.model_status?.algorithm ||
            data.model_meta?.model;
          const algorithm = algorithmRaw ? prettifyName(algorithmRaw) : null;
          const accRaw =
            data.model_status?.accuracy ?? data.model_meta?.accuracy ?? null;
          const accPct =
            typeof accRaw === "number"
              ? (accRaw * 100).toFixed(1) + "%"
              : typeof accRaw === "string"
              ? accRaw
              : null;
          const dsSize =
            data.model_status?.dataset_size ?? data.model_meta?.dataset_size;
          const trainedAtRaw =
            data.model_status?.training_date ?? data.model_meta?.training_date;
          const trainedAt = trainedAtRaw
            ? new Date(trainedAtRaw).toLocaleString()
            : null;

          // Derive numeric accuracy for health level
          const accNumeric =
            typeof accRaw === "number"
              ? accRaw
              : typeof accRaw === "string" && accRaw.includes("%")
              ? parseFloat(accRaw) / 100
              : typeof accRaw === "string"
              ? parseFloat(accRaw)
              : NaN;
          const healthLevel = !isNaN(accNumeric)
            ? accNumeric >= 0.8
              ? "High"
              : accNumeric >= 0.6
              ? "Medium"
              : "Low"
            : null;
          const healthClass =
            healthLevel === "High"
              ? "text-emerald-400"
              : healthLevel === "Medium"
              ? "text-yellow-400"
              : "text-red-400";

          statusContainer.innerHTML = `
            <div class="space-y-3">
              <div class="flex items-center justify-between">
                <span class="text-slate-400">Status</span>
                <div class="flex items-center">
                  <div class="w-2 h-2 ${
                    trained ? "bg-emerald-400" : "bg-yellow-400"
                  } rounded-full mr-2 animate-pulse"></div>
                  <span class="${
                    trained ? "text-emerald-400" : "text-yellow-400"
                  } font-medium">${trained ? "Active" : "Not trained"}</span>
                </div>
              </div>
              ${
                algorithm
                  ? `
                <div class="flex items-center justify-between">
                  <span class="text-slate-400">Algorithm</span>
                  <span class="text-white font-medium">${algorithm}</span>
                </div>`
                  : ""
              }
              ${
                healthLevel
                  ? `
                <div class="flex items-center justify-between">
                  <span class="text-slate-400">Health</span>
                  <span class="font-medium ${healthClass}">${healthLevel}</span>
                </div>`
                  : ""
              }
              ${
                accPct
                  ? `
                <div class="flex items-center justify-between">
                  <span class="text-slate-400">Accuracy</span>
                  <span class="text-indigo-400 font-medium">${accPct}</span>
                </div>`
                  : ""
              }
              ${
                dsSize
                  ? `
                <div class="flex items-center justify-between">
                  <span class="text-slate-400">Dataset Size</span>
                  <span class="text-purple-400 font-medium">${dsSize}</span>
                </div>`
                  : ""
              }
              ${
                trainedAt
                  ? `
                <div class="flex items-center justify-between">
                  <span class="text-slate-400">Last Trained</span>
                  <span class="text-pink-400 font-medium">${trainedAt}</span>
                </div>`
                  : ""
              }
              <div class="pt-2 border-t border-slate-700">
                <div class="text-xs text-slate-500">
                  Note: Accuracy is the model's overall test score. The Text Analyzer shows confidence for a single input.
                </div>
              </div>
              <!-- Charts -->
              <div class="mt-4 grid grid-cols-2 gap-4">
                <div class="bg-slate-900/40 rounded-xl p-3 border border-slate-700/50 min-w-0">
                  <div class="text-xs text-slate-400 mb-2">Accuracy</div>
                  <div class="relative h-36">
                    <canvas id="accuracyChart"></canvas>
                  </div>
                </div>
                <div class="bg-slate-900/40 rounded-xl p-3 border border-slate-700/50 min-w-0">
                  <div class="text-xs text-slate-400 mb-2">Data Split (Total / Train / Test)</div>
                  <div class="relative h-36">
                    <canvas id="dataSplitChart"></canvas>
                  </div>
                </div>
              </div>
            </div>`;

          // Render charts
          const accCanvas = document.getElementById("accuracyChart");
          const splitCanvas = document.getElementById("dataSplitChart");
          // Compute numeric accuracy in [0,1]
          const numericAcc = accNumeric;

          if (accCanvas && !isNaN(numericAcc)) {
            const accPct = Math.max(0, Math.min(100, (numericAcc || 0) * 100));
            if (accuracyChartInstance) accuracyChartInstance.destroy();
            accuracyChartInstance = new Chart(accCanvas.getContext("2d"), {
              type: "pie",
              data: {
                labels: ["Correct", "Other"],
                datasets: [
                  {
                    data: [accPct, 100 - accPct],
                    backgroundColor: ["#22c55e", "#64748b"],
                    borderWidth: 0,
                  },
                ],
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: { display: false },
                  tooltip: {
                    callbacks: {
                      label: (ctx) => `${ctx.label}: ${ctx.parsed.toFixed(1)}%`,
                    },
                  },
                },
              },
            });
          }

          // Radar chart for dataset split
          const trainCount =
            data.model_meta?.training_samples ??
            data.model_status?.training_samples;
          const testCount =
            data.model_meta?.test_samples ?? data.model_status?.test_samples;
          if (splitCanvas && dsSize && trainCount && testCount) {
            const maxVal = Math.max(dsSize, trainCount, testCount);
            if (dataSplitChartInstance) dataSplitChartInstance.destroy();
            dataSplitChartInstance = new Chart(splitCanvas.getContext("2d"), {
              type: "radar",
              data: {
                labels: ["Dataset", "Train", "Test"],
                datasets: [
                  {
                    label: "Samples",
                    data: [dsSize, trainCount, testCount],
                    backgroundColor: "rgba(99,102,241,0.45)",
                    borderColor: "#a78bfa",
                    pointBackgroundColor: "#f472b6",
                    borderWidth: 2,
                  },
                ],
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                  r: {
                    beginAtZero: true,
                    suggestedMax: Math.ceil(maxVal * 1.1),
                    grid: { color: "#475569" },
                    angleLines: { color: "#475569" },
                    pointLabels: { color: "#cbd5e1", font: { size: 10 } },
                    ticks: { display: false },
                  },
                },
              },
            });
          }
        } catch (error) {
          statusContainer.innerHTML = `
            <div class="flex items-center">
              <div class="w-2 h-2 bg-red-400 rounded-full mr-3"></div>
              <span class="text-red-400">Error loading status</span>
            </div>`;
        }
      }

      // Enhanced prediction function
      async function makePrediction() {
        const inputText = document.getElementById("inputText");
        const predictBtn = document.getElementById("predictBtn");
        const predictStatus = document.getElementById("predictStatus");
        const resultCard = document.getElementById("resultCard");

        const text = inputText.value.trim();

        if (!text) {
          showError("Please enter some text to analyze");
          return;
        }

        // Update button state
        predictBtn.disabled = true;
        predictBtn.innerHTML = `
          <svg class="w-5 h-5 mr-2 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
          </svg>
          Analyzing...
        `;

        predictStatus.textContent = "Processing text...";
        resultCard.classList.add("hidden");

        try {
          const response = await fetch("/predict", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ text: text }),
          });

          const data = await response.json();

          if (response.ok) {
            displayResult(data);
            predictStatus.textContent = "";
          } else {
            showError(data.error || "Prediction failed");
          }
        } catch (error) {
          showError("Network error. Please try again.");
        } finally {
          // Reset button
          predictBtn.disabled = false;
          predictBtn.innerHTML = `
            <svg class="w-5 h-5 mr-2 group-hover:rotate-12 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
            Analyze Text
          `;
        }
      }

      // Enhanced result display
      function displayResult(data) {
        const resultCard = document.getElementById("resultCard");
        const predictionText = document.getElementById("predictionText");
        const probabilities = document.getElementById("probabilities");
        const confidenceBadge = document.getElementById("confidenceBadge");
        const confidenceMeter = document.getElementById("confidenceMeter");

        const prediction = data.prediction;
        const confidence = data.confidence;
        const confidencePct =
          typeof confidence === "number"
            ? confidence * 100
            : parseFloat(confidence) || 0;
        const humanProb =
          data.probabilities.Human || data.probabilities.human || 0;
        const aiProb = data.probabilities.AI || data.probabilities.ai || 0;

        // Set prediction text with enhanced styling
        const isAI = prediction.toLowerCase() === "ai";
        predictionText.innerHTML = `
          <span class="flex items-center">
            <span class="w-3 h-3 rounded-full mr-3 ${
              isAI ? "bg-red-400" : "bg-emerald-400"
            }"></span>
            <span class="${
              isAI ? "text-red-400" : "text-emerald-400"
            }">${prediction}-generated</span>
          </span>
        `;

        // Set confidence badge with explicit level label to avoid confusion with model accuracy
        const confLevel =
          confidencePct >= 80 ? "High" : confidencePct >= 60 ? "Medium" : "Low";
        confidenceBadge.textContent = `Confidence: ${confLevel} (${confidencePct.toFixed(
          1
        )}%)`;
        confidenceBadge.className = `px-3 py-1 rounded-full text-xs font-medium ${
          confidencePct >= 80
            ? "bg-emerald-600 text-white"
            : confidencePct >= 60
            ? "bg-yellow-600 text-white"
            : "bg-red-600 text-white"
        }`;

        // Set probabilities
        probabilities.innerHTML = `
          <div class="grid grid-cols-2 gap-4 text-sm">
            <div class="text-center">
              <div class="text-emerald-400 font-semibold">${(
                humanProb * 100
              ).toFixed(1)}%</div>
              <div class="text-slate-400">Human</div>
            </div>
            <div class="text-center">
              <div class="text-red-400 font-semibold">${(aiProb * 100).toFixed(
                1
              )}%</div>
              <div class="text-slate-400">AI</div>
            </div>
          </div>
        `;

        // Set confidence meter
        const meterWidth = (aiProb * 100).toFixed(1);
        confidenceMeter.style.width = `${meterWidth}%`;
        confidenceMeter.className = `h-2 rounded-full transition-all duration-500 ${
          aiProb > 0.5
            ? "bg-gradient-to-r from-yellow-500 to-red-500"
            : "bg-gradient-to-r from-emerald-500 to-blue-500"
        }`;

        // Show result card with animation
        resultCard.classList.remove("hidden");
        setTimeout(() => {
          resultCard.style.transform = "translateY(0)";
          resultCard.style.opacity = "1";
        }, 10);
      }

      // Error display function
      function showError(message) {
        const predictStatus = document.getElementById("predictStatus");
        predictStatus.innerHTML = `<span class="text-red-400">${message}</span>`;
        setTimeout(() => {
          predictStatus.textContent = "";
        }, 3000);
      }
    </script>
  </body>
</html>
